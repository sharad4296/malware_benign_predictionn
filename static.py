#!/usr/bin/env python
# coding: utf-8

# In[1]:


import random
import os
import json
import re 
import pandas as pd 
import numpy as np
from sklearn.ensemble import RandomForestClassifier
import pickle
import csv

def fun1(dirName,entry):
    list9 = ['GetStdHandle','GetDriveTypeW','ReleaseMutex','WaitForSingleObject','inet_addr','GetDriveTypeA','FindNextFileA','SignalObjectAndWait','FindResourceExW','CreateStreamOnHGlobal','CharUpperBuffW','InitializeSListHead','DrawTextA','GetTempPathA','SendMessageW','GetUserNameW','GetCPInfo','TranslateMessage','CreateDIBitmap','SendMessageA','GetTempPathW','DrawTextW','ImageList_ReplaceIcon','CallNextHookEx','SetFileAttributesA','MoveFileA','AlphaBlend','OutputDebugStringW','TlsGetValue','MoveFileW','MsgWaitForMultipleObjects','DestroyMenu','RegCreateKeyExW','GetSystemTime','GetUserDefaultLangID','VerQueryValueW','RegQueryValueExA','HeapAlloc','RegCreateKeyExA','RegQueryValueExW','VerQueryValueA','SetSecurityDescriptorDacl','GetMenuState','LoadLibraryExA','SysReAllocStringLen','GetDlgItemTextA','LoadLibraryExW','IsWindowEnabled','MoveFileExW','SetEnvironmentVariableW','GetSystemDirectoryW','free','IsProcessorFeaturePresent','GetSystemDirectoryA','DecodePointer','SetEnvironmentVariableA','GetWindowLongA','CoTaskMemFree','FillRect','GetModuleHandleExW','CharNextA','WaitForInputIdle','GetSysColorBrush','LocalFileTimeToFileTime','GetTextColor','ReadConsoleW','GetWindowLongW','CharNextW','SetFocus','OleUninitialize','CoUninitialize','HeapFree','DefWindowProcW','KillTimer','TlsAlloc','GetClipBox','DefWindowProcA','_cexit','IsIconic','DosDateTimeToFileTime','OpenProcessToken','SetRectEmpty','GlobalDeleteAtom','PostMessageA','DeleteFileA','DeleteFileW','GlobalLock','CompareStringW','SHGetFolderPathW','GetLastActivePopup','ExpandEnvironmentStringsW','RegEnumKeyExW','GetDCEx','CompareStringA','SelectClipRgn','WaitForMultipleObjects','ScreenToClient','ExpandEnvironmentStringsA','FindWindowExA','GetMenuItemCount','ValidateRect','CommandLineToArgvW','SysStringLen','SystemTimeToFileTime','VirtualAllocEx','GetSystemInfo','GetRgnBox','SaveDC','GlobalUnlock','MessageBeep','WinVerifyTrust','GetWindowThreadProcessId','_c_exit','GetMenu','CompareFileTime','WritePrivateProfileStringA','MessageBoxIndirectA','MoveWindow','SetFileTime','GetCurrentDirectoryA','GetWindowDC','AdjustWindowRectEx','GetSysColor','GetCurrentThread','lstrcpynW','RaiseException','CreateDialogIndirectParamW','_adjust_fdiv','GetTimeFormatA','lstrcpynA','GetACP','CreateCompatibleDC','wsprintfA','CallWindowProcW','GetEnvironmentStrings','CreateProcessA','GetCurrentDirectoryW','HeapCreate','GetClientRect','CreateProcessW','CallWindowProcA','SHGetSpecialFolderLocation','wsprintfW','CreateCompatibleBitmap','__p__fmode','GetMessagePos','FileTimeToSystemTime','LoadBitmapW','HeapDestroy','LoadBitmapA','SetWindowPos','_except_handler3','GetCurrentProcess','IsWindow','GetConsoleMode','CoCreateGuid','WindowFromPoint','ShellExecuteExW','PatBlt','StretchDIBits','GetDC','RegOpenKeyW','ReleaseDC','GetClassInfoA','ImageList_AddMasked','OffsetRect','GetClassInfoW','InitCommonControlsEx','SetScrollPos','FreeLibrary','LocalFree','FormatMessageW','GetActiveWindow','LoadResource','SetWindowExtEx','GetMappedFileNameA','FormatMessageA','WritePrivateProfileStringW','GetBkColor','GetMessageA','CopyFileW','SHFileOperationW','CertCloseStore','GetModuleFileNameW','EnumWindows','IsDebuggerPresent','ExitProcess','GetMessageW','ShowWindow','GetModuleFileNameA','SHFileOperationA','EnableWindow','LoadImageA','InterlockedDecrement','MultiByteToWideChar','SetFilePointerEx','BitBlt','GetWindow','SysFreeString','CreateMutexA','SHDeleteKeyW','ImageList_Destroy','SetParent','SetClipboardData','IsZoomed','GetWindowPlacement','SetUnhandledExceptionFilter','CreateMutexW','MulDiv','__getmainargs','EnableMenuItem','MoveFileExA','GetSubMenu','SysAllocStringLen','ShowOwnedPopups','GlobalAlloc','SearchPathA','GetVersion','PtInRect','IsChild','MapWindowPoints','AreFileApisANSI','InitializeCriticalSectionAndSpinCount','EnterCriticalSection','SetHandleCount','lstrcmpiA','InitCommonControls','GetScrollPos','GetOEMCP','GetTickCount','FlushFileBuffers','lstrcmpiW','RtlUnwind','GetObjectA','SendDlgItemMessageA','GetSystemMetrics','GetDateFormatA','DeleteDC','GetWindowsDirectoryW','DeregisterEventSource','UpdateWindow','SHGetPathFromIDListW','VariantCopyInd','CreateDirectoryA','GetModuleHandleW','GetWindowsDirectoryA','GetDateFormatW','GetObjectW','SendDlgItemMessageW','CreateDirectoryW','SHGetPathFromIDListA','CheckDlgButton','GetTempFileNameW','VariantChangeType','memset','CreatePopupMenu','CheckMenuItem','GetFileSizeEx','GlobalReAlloc','CreateBitmap','CoCreateInstance','XZ','lstrcpyA','GetDlgItem','ResetEvent','CreateDialogParamA','ClientToScreen','GetUserDefaultLCID','CreateRectRgn','IsDlgButtonChecked','CreateFileW','VirtualProtectEx','GetSystemMenu','SetViewportOrgEx','TlsSetValue','CreateFileA','SetPropW','CreateDialogParamW','LocalReAlloc','EndDialog','lstrlenA','GlobalFree','GetCapture','AdjustTokenPrivileges','GetEnvironmentStringsW','lstrcpyW','IsDBCSLeadByte','lstrlenW','GetPropA','GetCurrentProcessId','LockResource','DialogBoxParamW','DialogBoxParamA','GetKeyState','SystemParametersInfoA','CoInitialize','OleInitialize','ExcludeClipRect','RegQueryInfoKeyW','SetFilePointer','ReadFile','SystemParametersInfoW','PeekMessageW','SendMessageTimeoutA','CoTaskMemAlloc','DeviceIoControl','SelectObject','IsValidCodePage','UnmapViewOfFile','IsRectEmpty','GetClassNameA','CloseClipboard','__set_app_type','GetTempFileNameA','GetConsoleOutputCP','GetFileAttributesA','EncodePointer','PostQuitMessage','GetForegroundWindow','GetFileAttributesW','GetLocalTime','LocalAlloc','lstrcatA','RegOpenKeyExW','PeekMessageA','_XcptFilter','RegOpenKeyExA','lstrcatW','SHGetMalloc','SetActiveWindow','GetDlgCtrlID','UnregisterClassA','GetStringTypeA','GetDiskFreeSpaceW','UnregisterClassW','WriteFile','HeapReAlloc','GetStringTypeW','LoadImageW','GdipFree','GetEnvironmentVariableA','FindClose','RedrawWindow','GetEnvironmentVariableW','SetLastError','DestroyWindow','LookupPrivilegeValueA','SHBrowseForFolderW','CreateFontIndirectW','GetPropW','EqualRect','CreateFontIndirectA','SHBrowseForFolderA','LookupPrivilegeValueW','SetClassLongA','GetPixel','VerSetConditionMask','SetThreadPriority','CharUpperW','UnhandledExceptionFilter','LoadStringA','CreateThread','CreateBrushIndirect','LoadStringW','SafeArrayGetVartype','RegDeleteValueW','CreateWindowExA','RegSetValueExW','WriteConsoleA','SetCurrentDirectoryW','CopyRect','VirtualQuery','DispatchMessageA','ImageList_Create','RegDeleteValueA','CreateWindowExW','GetLocaleInfoA','_initterm','LeaveCriticalSection','DeleteObject','SetCurrentDirectoryA','WriteConsoleW','CharPrevA','RegCloseKey','BeginPaint','GetVersionExW','SetEvent','IsBadWritePtr','GetVersionExA','GetDeviceCaps','GetStartupInfoA','GetWindowRect','GetFileSize','DrawIcon','GetShortPathNameW','GetStartupInfoW','GetTokenInformation','GetProcAddress','RealizePalette','SetWindowTextA','CoInitializeEx','lstrcmpA','GetStockObject','FindFirstFileA','SetWindowTextW','FindFirstFileW','IsValidLocale','lstrcmpW','SetFileAttributesW','CreateEnvironmentBlock','RegEnumValueW','LoadCursorA','LoadIconA','TrackPopupMenu','CreateEventW','PostThreadMessageW','AllocateAndInitializeSid','GetDesktopWindow','CreateEventA','LoadCursorW','LoadIconW','RegEnumValueA','GetFileType','SetForegroundWindow','_controlfp','InternetOpenW','ExitWindowsEx','InterlockedIncrement','RegDeleteKeyA','EmptyClipboard','malloc','LCMapStringW','FindWindowW','LCMapStringA','GetThreadLocale','RegDeleteKeyW','FindWindowA','VariantChangeTypeEx','RegOpenKeyA','FileTimeToLocalFileTime','SizeofResource','RegSetValueExA','RestoreDC','SetDlgItemTextA','GetDiskFreeSpaceExW','GetCommandLineW','HeapSize','GetCommandLineA','DispatchMessageW','SetDlgItemTextW','SetTextColor','DestroyIcon','MapViewOfFile','TlsFree','GetModuleHandleA','IsWindowVisible','SetMenu','ExtTextOutW','GetCurrentThreadId','InitializeSecurityDescriptor','GetDiskFreeSpaceA','GetFileVersionInfoA','SetViewportExtEx','VirtualFree','GetFileVersionInfoW','GetFocus','UnhookWindowsHookEx','SetCursor','GetUserNameExW','GetFileVersionInfoSizeA','SetMapMode','SysAllocString','GetFileVersionInfoSizeW','SystemTimeToTzSpecificLocalTime','FreeEnvironmentStringsA','DeleteCriticalSection','EndPaint','SetErrorMode','IntersectClipRect','FreeEnvironmentStringsW','GetMenuItemID','GetLocaleInfoW','GetCursorPos','SetStdHandle','GetFileTime','WideCharToMultiByte','CreatePalette','InterlockedExchange','_lopen','GetSystemTimeAsFileTime','StretchBlt','Escape','GetFullPathNameA','WSAStartup','ResumeThread','CoRevokeClassObject','GetTopWindow','InitializeCriticalSection','GetWindowTextW','GlobalHandle','Arc','GetWindowTextLengthW','GetFullPathNameW','SetBkColor','GetParent','YAXXZ','SetPropA','GetSystemDefaultLangID','VariantInit','SHGetFileInfoA','HeapSetInformation','GetPrivateProfileStringA','_CorExeMain','GetSystemDefaultLCID','exit','EnumCalendarInfoW','SHGetFileInfoW','GetPrivateProfileStringW','RegisterClassW','SelectPalette','GetWindowTextA','ExitThread','RegisterClassA','SetTimer','TerminateProcess','IsDialogMessageW','CryptMsgClose','SetEndOfFile','_exit','IsDialogMessageA','CloseHandle','BringWindowToTop','RegisterWindowMessageW','OpenProcess','LoadLibraryW','GetExitCodeProcess','QueryPerformanceCounter','VirtualProtect','LoadLibraryA','GetClassInfoExW','SetWindowLongW','InflateRect','SetCapture','ReleaseCapture','SetWindowLongA','__setusermatherr','CLSIDFromString','GetProcessHeap','CreateFileMappingW','RemoveDirectoryW','__p__commode','CryptAcquireContextW','RemovePropW','CreateFileMappingA','DuplicateHandle','FindFirstFileExW','PostMessageW','GetClassNameW','GetTimeZoneInformation','FreeSid','ShellExecuteW','CopyFileA','GetErrorInfo','GetTextExtentPoint32W','ShellExecuteA','OpenClipboard','GetLastError','CLSIDFromProgID','IntersectRect','GetConsoleCP','CryptReleaseContext','RemoveDirectoryA','GetShortPathNameA','MessageBoxW','AppendMenuA','RegEnumKeyW','MessageBoxA','DestroyCursor','RegEnumKeyA','InterlockedCompareExchange','SuspendThread','RectVisible','DeleteMenu','timeGetTime','SHGetSpecialFolderPathA','CharToOemA','FindNextFileW','SetRect','FreeResource','InvalidateRect','VariantCopy','VirtualAlloc','FindResourceW','VariantClear','CreateSolidBrush','Sleep','IsBadReadPtr','SetBkMode','FindResourceA','GetKeyboardType','DllCharacteristics','BaseOfCode','MajorLinkerVersion','MinorOperatingSystemVersion','Machine','MajorSubsystemVersion','LoaderFlags','SizeOfStackCommit','SizeOfUninitializedData','MinorSubsystemVersion','SizeOfHeapReserve','SizeOfHeapCommit','SizeOfStackReserve','BaseOfData','SizeOfHeaders','Subsystem','MinorImageVersion','MajorImageVersion','FileAlignment','MajorOperatingSystemVersion','SizeOfOptionalHeader','AddressOfEntryPoint','SectionAlignment','SizeOfCode','Characteristics','SizeOfInitializedData','SizeOfImage','NumberOfRvaAndSizes','ImageBase','MinorLinkerVersion','CheckSum']
    let = {'GetStdHandle':0,'GetDriveTypeW':0,'SysStringByteLen':0,'ReleaseMutex':0,'ConvertSidToStringSidW':0,'fclose':0,'WaitForSingleObject':0,'inet_addr':0,'GetDriveTypeA':0,'FindNextFileA':0,'SignalObjectAndWait':0,'CombineRgn':0,'FindResourceExW':0,'SetWindowRgn':0,'CreateStreamOnHGlobal':0,'RegEnumKeyExA':0,'SafeArrayGetLBound':0,'GetTextExtentPointA':0,'GetFileTitleA':0,'GetVolumeInformationW':0,'send':0,'UuidToStringW':0,'CharUpperBuffW':0,'InitializeSListHead':0,'DrawTextA':0,'GetTempPathA':0,'SendMessageW':0,'GetUserNameW':0,'GetCPInfo':0,'terminate':0,'TranslateMessage':0,'SetEntriesInAclW':0,'CreateDIBitmap':0,'SendMessageA':0,'TabbedTextOutW':0,'GetTempPathW':0,'GetMenuItemInfoW':0,'DrawTextW':0,'GetNextDlgTabItem':0,'ImageList_ReplaceIcon':0,'CallNextHookEx':0,'SetFileAttributesA':0,'MoveFileA':0,'ImageList_Remove':0,'AlphaBlend':0,'SetWindowsHookExA':0,'OutputDebugStringW':0,'CoInitializeSecurity':0,'TlsGetValue':0,'MoveFileW':0,'MsgWaitForMultipleObjects':0,'DestroyMenu':0,'OutputDebugStringA':0,'CM_Get_DevNode_Status':0,'CopyMetaFileW':0,'RegCreateKeyExW':0,'GetSystemTime':0,'GetKeyNameTextA':0,'CopyAcceleratorTableW':0,'GetUserDefaultLangID':0,'VerQueryValueW':0,'RegQueryValueExA':0,'wcschr':0,'GetCurrentPositionEx':0,'CreateToolhelp32Snapshot':0,'_stricmp':0,'OpenServiceW':0,'HeapAlloc':0,'CoFreeUnusedLibraries':0,'RegCreateKeyExA':0,'RegSetValueW':0,'GetIconInfo':0,'CreateFontW':0,'InternetSetOptionW':0,'RegQueryValueExW':0,'VerQueryValueA':0,'SetSecurityDescriptorDacl':0,'GetMenuState':0,'OffsetViewportOrgEx':0,'LoadLibraryExA':0,'__vbaExceptHandler':0,'SetWindowsHookExW':0,'InsertMenuItemW':0,'SysReAllocStringLen':0,'GetDlgItemTextA':0,'LoadLibraryExW':0,'WSAGetLastError':0,'IsWindowEnabled':0,'GetDlgItemTextW':0,'MoveFileExW':0,'InsertMenuItemA':0,'CM_Get_Parent':0,'GlobalAddAtomW':0,'SetEnvironmentVariableW':0,'GetSystemDirectoryW':0,'ScaleWindowExtEx':0,'GetViewportExtEx':0,'free':0,'IsProcessorFeaturePresent':0,'GetSystemDirectoryA':0,'DecodePointer':0,'SetEnvironmentVariableA':0,'GetWindowLongA':0,'CoTaskMemFree':0,'GlobalMemoryStatus':0,'OemToCharA':0,'FillRect':0,'GetModuleHandleExW':0,'CharNextA':0,'WaitForInputIdle':0,'GetSysColorBrush':0,'LocalFileTimeToFileTime':0,'GetTextColor':0,'EqualSid':0,'ReadConsoleW':0,'GetWindowLongW':0,'CharNextW':0,'AppendMenuW':0,'CreatePenIndirect':0,'DrawMenuBar':0,'SetFocus':0,'OleUninitialize':0,'CoUninitialize':0,'HeapFree':0,'__wgetmainargs':0,'LoadMenuW':0,'DefWindowProcW':0,'SetMenuItemInfoA':0,'KillTimer':0,'StgOpenStorageOnILockBytes':0,'CharUpperBuffA':0,'TlsAlloc':0,'GetClipBox':0,'DefWindowProcA':0,'IsWindowUnicode':0,'GetClipboardData':0,'_cexit':0,'IsIconic':0,'DosDateTimeToFileTime':0,'OpenProcessToken':0,'CreateStdAccessibleObject':0,'SetRectEmpty':0,'GlobalDeleteAtom':0,'PostMessageA':0,'EnumChildWindows':0,'DeleteFileA':0,'SafeArrayDestroy':0,'RegFlushKey':0,'SHGetDataFromIDListW':0,'DeleteFileW':0,'GlobalLock':0,'CreateILockBytesOnHGlobal':0,'CreatePatternBrush':0,'CompareStringW':0,'SHGetFolderPathW':0,'GetLastActivePopup':0,'ExpandEnvironmentStringsW':0,'RegEnumKeyExW':0,'GetDCEx':0,'CompareStringA':0,'SelectClipRgn':0,'WaitForMultipleObjects':0,'ScreenToClient':0,'ExpandEnvironmentStringsA':0,'CryptDestroyHash':0,'FindCloseChangeNotification':0,'FindWindowExA':0,'OleFlushClipboard':0,'GetMenuItemCount':0,'CryptGetHashParam':0,'SearchPathW':0,'ValidateRect':0,'GetKeyboardLayout':0,'SetWindowOrgEx':0,'FindWindowExW':0,'SetSecurityDescriptorOwner':0,'CommandLineToArgvW':0,'SetupDiEnumDeviceInterfaces':0,'GlobalGetAtomNameW':0,'SysStringLen':0,'SystemTimeToFileTime':0,'EnumResourceLanguagesW':0,'DrawTextExW':0,'VirtualAllocEx':0,'GetSystemInfo':0,'GetRgnBox':0,'SaveDC':0,'CreateDialogIndirectParamA':0,'fprintf':0,'InternetErrorDlg':0,'CryptHashData':0,'GlobalUnlock':0,'MessageBeep':0,'WinVerifyTrust':0,'tan':0,'HttpOpenRequestW':0,'RemoveMenu':0,'GetWindowThreadProcessId':0,'_c_exit':0,'WaitForSingleObjectEx':0,'GetMenu':0,'CompareFileTime':0,'WritePrivateProfileStringA':0,'MessageBoxIndirectA':0,'MoveWindow':0,'SetFileTime':0,'__initenv':0,'GetCurrentDirectoryA':0,'GetWindowDC':0,'StringFromGUID2':0,'AdjustWindowRectEx':0,'SetupDiDestroyDeviceInfoList':0,'GetSysColor':0,'GetCurrentThread':0,'lstrcpynW':0,'OleCreateFontIndirect':0,'_wcsicmp':0,'RaiseException':0,'CreateDialogIndirectParamW':0,'_adjust_fdiv':0,'ShowScrollBar':0,'WSACleanup':0,'gethostbyname':0,'Process32NextW':0,'_lclose':0,'GetTimeFormatA':0,'lstrcpynA':0,'GetACP':0,'CreateCompatibleDC':0,'FrameRect':0,'_lwrite':0,'wsprintfA':0,'CallWindowProcW':0,'GetEnvironmentStrings':0,'CreateProcessA':0,'GetUserNameA':0,'GetCurrentDirectoryW':0,'HeapCreate':0,'GetClientRect':0,'GetNumberFormatW':0,'CreateProcessW':0,'CallWindowProcA':0,'SHGetSpecialFolderLocation':0,'wsprintfW':0,'_iob':0,'CreateCompatibleBitmap':0,'__p__fmode':0,'RegisterClipboardFormatA':0,'GetMessagePos':0,'FileTimeToDosDateTime':0,'FileTimeToSystemTime':0,'LoadBitmapW':0,'RegCreateKeyW':0,'GetTextMetricsA':0,'HeapDestroy':0,'RegCreateKeyA':0,'LoadBitmapA':0,'SetWindowPos':0,'_except_handler3':0,'setsockopt':0,'ShellExecuteExA':0,'GetCurrentProcess':0,'IsWindow':0,'GetConsoleMode':0,'CoCreateGuid':0,'GetOpenFileNameA':0,'WindowFromPoint':0,'CoRegisterMessageFilter':0,'ShellExecuteExW':0,'PatBlt':0,'GetMessageTime':0,'StretchDIBits':0,'GetThreadContext':0,'GetDC':0,'RegOpenKeyW':0,'ReleaseDC':0,'GetClassInfoA':0,'ImageList_AddMasked':0,'CreatePen':0,'OffsetRect':0,'DefFrameProcA':0,'GetClassInfoW':0,'SetWindowContextHelpId':0,'GetDIBits':0,'EnumCalendarInfoA':0,'LoadKeyboardLayoutA':0,'InitCommonControlsEx':0,'SetScrollPos':0,'MessageBoxIndirectW':0,'FreeLibrary':0,'LocalFree':0,'FormatMessageW':0,'VariantTimeToSystemTime':0,'DragFinish':0,'GetActiveWindow':0,'LoadResource':0,'RegisterClipboardFormatW':0,'SetWindowExtEx':0,'GetMappedFileNameA':0,'FormatMessageA':0,'VarDateFromStr':0,'WritePrivateProfileStringW':0,'GetBkColor':0,'GetMessageA':0,'GetDIBColorTable':0,'CopyFileW':0,'TextOutW':0,'SHFileOperationW':0,'CertCloseStore':0,'GetModuleFileNameW':0,'EnumWindows':0,'TextOutA':0,'DefMDIChildProcA':0,'IsDebuggerPresent':0,'ExitProcess':0,'connect':0,'GetMessageW':0,'ShowWindow':0,'GetModuleFileNameA':0,'DrawFrameControl':0,'SHFileOperationA':0,'CloseServiceHandle':0,'fopen':0,'DrawAnimatedRects':0,'EnableWindow':0,'SetWindowPlacement':0,'LoadImageA':0,'_vsnwprintf':0,'CM_Get_Device_IDW':0,'InterlockedDecrement':0,'MultiByteToWideChar':0,'sprintf':0,'SetFilePointerEx':0,'BitBlt':0,'GetWindow':0,'SysFreeString':0,'FlushInstructionCache':0,'ImageList_Draw':0,'__WSAFDIsSet':0,'CreateMutexA':0,'CreateFontA':0,'SHDeleteKeyW':0,'ImageList_Destroy':0,'CoLockObjectExternal':0,'SetParent':0,'SetClipboardData':0,'IsZoomed':0,'GetWindowPlacement':0,'SetUnhandledExceptionFilter':0,'PtVisible':0,'CreateMutexW':0,'MulDiv':0,'__getmainargs':0,'UnlockFile':0,'EnableMenuItem':0,'MoveFileExA':0,'SetupDiGetClassDevsW':0,'GetSubMenu':0,'CreateMenu':0,'SetROP2':0,'SysAllocStringLen':0,'ShowOwnedPopups':0,'GlobalAlloc':0,'DeferWindowPos':0,'SearchPathA':0,'calloc':0,'GetVersion':0,'PtInRect':0,'IsChild':0,'_wcsnicmp':0,'MapWindowPoints':0,'AreFileApisANSI':0,'GetMonitorInfoW':0,'InitializeCriticalSectionAndSpinCount':0,'EnterCriticalSection':0,'DrawEdge':0,'SetHandleCount':0,'lstrcmpiA':0,'InitCommonControls':0,'GetScrollPos':0,'GetOEMCP':0,'SetFileSecurityW':0,'GetTickCount':0,'FlushFileBuffers':0,'lstrcmpiW':0,'CryptDecryptMessage':0,'RtlUnwind':0,'LresultFromObject':0,'strncpy':0,'GetObjectA':0,'SendDlgItemMessageA':0,'GetSystemMetrics':0,'GetDateFormatA':0,'DeleteDC':0,'GetWindowsDirectoryW':0,'DeregisterEventSource':0,'GetMapMode':0,'UpdateWindow':0,'SHGetPathFromIDListW':0,'VariantCopyInd':0,'CreateDirectoryA':0,'GetModuleHandleW':0,'GetWindowsDirectoryA':0,'GetDateFormatW':0,'__CxxFrameHandler':0,'GetObjectW':0,'SendDlgItemMessageW':0,'CreateDirectoryW':0,'PathStripToRootW':0,'SHGetPathFromIDListA':0,'CheckDlgButton':0,'GetTempFileNameW':0,'VariantChangeType':0,'memset':0,'CreatePopupMenu':0,'CheckMenuItem':0,'GetFileSizeEx':0,'GlobalReAlloc':0,'CreateBitmap':0,'CoCreateInstance':0,'XZ':0,'lstrcpyA':0,'UnrealizeObject':0,'GetDlgItem':0,'ResetEvent':0,'CreateDialogParamA':0,'ClientToScreen':0,'GetUserDefaultLCID':0,'GetClassLongA':0,'std':0,'VarUI4FromStr':0,'CreateRectRgn':0,'GetKeyboardState':0,'RegisterTypeLib':0,'GetMenuStringA':0,'IsDlgButtonChecked':0,'CreateFileW':0,'VirtualProtectEx':0,'GetSystemMenu':0,'HttpSendRequestW':0,'SetViewportOrgEx':0,'TlsSetValue':0,'CreateFileA':0,'SetPropW':0,'GetMenuStringW':0,'CreateDialogParamW':0,'LocalReAlloc':0,'ImageList_SetBkColor':0,'OpenSCManagerW':0,'EndDialog':0,'lstrlenA':0,'GlobalFree':0,'CreateIcon':0,'GetCapture':0,'AdjustTokenPrivileges':0,'WaitMessage':0,'GetProcessTimes':0,'GetEnvironmentStringsW':0,'lstrcpyW':0,'IsDBCSLeadByte':0,'GetTextMetricsW':0,'lstrlenW':0,'WinExec':0,'FindFirstChangeNotificationW':0,'InternetConnectW':0,'LockWindowUpdate':0,'RegQueryValueA':0,'GetPropA':0,'GetCurrentProcessId':0,'LockResource':0,'DialogBoxParamW':0,'GetNextDlgGroupItem':0,'GetClassLongW':0,'InternetReadFile':0,'DialogBoxParamA':0,'CertGetCertificateChain':0,'memmove':0,'CryptUIDlgViewCertificateW':0,'CoTaskMemRealloc':0,'RegQueryValueW':0,'GetKeyState':0,'printf':0,'SystemParametersInfoA':0,'CoInitialize':0,'OleInitialize':0,'ExcludeClipRect':0,'RegQueryInfoKeyW':0,'SetFilePointer':0,'ReadFile':0,'SystemParametersInfoW':0,'GetLengthSid':0,'RegisterClassExA':0,'RegQueryInfoKeyA':0,'PeekMessageW':0,'SendMessageTimeoutA':0,'SetBrushOrgEx':0,'CoTaskMemAlloc':0,'DeviceIoControl':0,'SelectObject':0,'IsValidCodePage':0,'UnmapViewOfFile':0,'ExtTextOutA':0,'IsRectEmpty':0,'GetClassNameA':0,'SendMessageTimeoutW':0,'SetConsoleCtrlHandler':0,'CloseClipboard':0,'ImageList_GetBkColor':0,'TranslateAcceleratorW':0,'__set_app_type':0,'SetThreadLocale':0,'GetTempFileNameA':0,'GetConsoleOutputCP':0,'CertFreeCertificateContext':0,'SetMenuItemBitmaps':0,'GetFileAttributesA':0,'GetTimeFormatW':0,'AddAccessAllowedAce':0,'QAE':0,'EncodePointer':0,'PostQuitMessage':0,'GetForegroundWindow':0,'GetFileAttributesW':0,'GetSystemPaletteEntries':0,'GetLocalTime':0,'GetMenuCheckMarkDimensions':0,'LocalAlloc':0,'OpenIcon':0,'lstrcatA':0,'EnumSystemLocalesW':0,'RegOpenKeyExW':0,'SetPixel':0,'wcscmp':0,'PeekMessageA':0,'_llseek':0,'_XcptFilter':0,'LookupAccountNameW':0,'RegOpenKeyExA':0,'OleDuplicateData':0,'lstrcatW':0,'SHGetMalloc':0,'SetActiveWindow':0,'CertGetIntendedKeyUsage':0,'MapDialogRect':0,'GetDlgCtrlID':0,'UnregisterClassA':0,'GetStringTypeA':0,'GetDiskFreeSpaceW':0,'UnregisterClassW':0,'WriteFile':0,'HeapReAlloc':0,'GetStringTypeW':0,'memcpy':0,'IsClipboardFormatAvailable':0,'GetProfileIntW':0,'LoadImageW':0,'GdipFree':0,'GetEnvironmentVariableA':0,'GetPaletteEntries':0,'GetStringTypeExW':0,'PathQuoteSpacesW':0,'FindClose':0,'RedrawWindow':0,'GetEnvironmentVariableW':0,'SetLastError':0,'DestroyWindow':0,'LookupPrivilegeValueA':0,'DragQueryFileW':0,'SHBrowseForFolderW':0,'CreateFontIndirectW':0,'GetPropW':0,'EqualRect':0,'SetClassLongW':0,'CreateFontIndirectA':0,'SHBrowseForFolderA':0,'LookupPrivilegeValueW':0,'SetClassLongA':0,'wcscpy':0,'GetPixel':0,'VerSetConditionMask':0,'strchr':0,'CharToOemBuffA':0,'EnumSystemLocalesA':0,'GetFileTitleW':0,'SetThreadPriority':0,'CharUpperW':0,'GetSaveFileNameA':0,'UnhandledExceptionFilter':0,'ChildWindowFromPoint':0,'VerifyVersionInfoW':0,'GetAsyncKeyState':0,'CharUpperA':0,'ActivateKeyboardLayout':0,'SysAllocStringByteLen':0,'_acmdln':0,'YAPAXI':0,'LoadStringA':0,'CreateThread':0,'CreateBrushIndirect':0,'GetExitCodeThread':0,'CryptGenRandom':0,'LoadStringW':0,'_except_handler4_common':0,'PathAppendW':0,'GetKeyboardLayoutList':0,'SafeArrayGetVartype':0,'OleRun':0,'ExtSelectClipRgn':0,'GetFileInformationByHandle':0,'ImmGetContext':0,'GlobalAddAtomA':0,'RegDeleteValueW':0,'CreateWindowExA':0,'RegSetValueExW':0,'WriteConsoleA':0,'SetCurrentDirectoryW':0,'CopyRect':0,'VirtualQuery':0,'DispatchMessageA':0,'ImageList_Create':0,'RegDeleteValueA':0,'CreateWindowExW':0,'GetLocaleInfoA':0,'OleIsCurrentClipboard':0,'_initterm':0,'LeaveCriticalSection':0,'DeleteObject':0,'SetCurrentDirectoryA':0,'WriteConsoleW':0,'CharPrevA':0,'RegCloseKey':0,'QueryServiceStatus':0,'SetupDiGetDeviceInterfaceDetailW':0,'BeginPaint':0,'GetVersionExW':0,'SetEvent':0,'IsBadWritePtr':0,'SetStretchBltMode':0,'GetVersionExA':0,'Rectangle':0,'GetDeviceCaps':0,'CharLowerA':0,'GetStartupInfoA':0,'SetScrollRange':0,'GetWindowRect':0,'GetFileSize':0,'InternetCloseHandle':0,'DrawIcon':0,'GetCharWidthW':0,'GetShortPathNameW':0,'ImageList_DrawEx':0,'GetStartupInfoW':0,'GetTokenInformation':0,'CreateHalftonePalette':0,'GetProcAddress':0,'GetPrivateProfileIntW':0,'RealizePalette':0,'GetNativeSystemInfo':0,'GetComputerNameW':0,'SetWindowTextA':0,'_lread':0,'CoInitializeEx':0,'SHGetDesktopFolder':0,'lstrcmpA':0,'GetStockObject':0,'FindFirstFileA':0,'SetWindowTextW':0,'GetComputerNameA':0,'FindFirstFileW':0,'IsValidLocale':0,'lstrcmpW':0,'closesocket':0,'SetFileAttributesW':0,'CreateEnvironmentBlock':0,'RegEnumValueW':0,'LoadCursorA':0,'LoadIconA':0,'TrackPopupMenu':0,'CreateEventW':0,'PostThreadMessageW':0,'GetMenuItemInfoA':0,'MoveToEx':0,'InternetOpenA':0,'AllocateAndInitializeSid':0,'ReleaseStgMedium':0,'GetDesktopWindow':0,'CreateEventA':0,'LoadCursorW':0,'LoadIconW':0,'RegEnumValueA':0,'GetFileType':0,'SetForegroundWindow':0,'_controlfp':0,'InternetOpenW':0,'ExitWindowsEx':0,'InterlockedIncrement':0,'RegDeleteKeyA':0,'EmptyClipboard':0,'malloc':0,'EnumThreadWindows':0,'LCMapStringW':0,'GetScrollRange':0,'GetScrollInfo':0,'FindWindowW':0,'DoDragDrop':0,'LCMapStringA':0,'ControlService':0,'GetThreadLocale':0,'RegDeleteKeyW':0,'FindWindowA':0,'LockFile':0,'VariantChangeTypeEx':0,'_amsg_exit':0,'BeginDeferWindowPos':0,'RegOpenKeyA':0,'FileTimeToLocalFileTime':0,'SizeofResource':0,'RegSetValueExA':0,'RestoreDC':0,'RegisterClassExW':0,'SetDlgItemTextA':0,'GetDiskFreeSpaceExW':0,'GetCommandLineW':0,'HeapSize':0,'GetCommandLineA':0,'DispatchMessageW':0,'SetDlgItemTextW':0,'SetTextColor':0,'PathRemoveExtensionW':0,'OpenMutexA':0,'HttpQueryInfoW':0,'CertOpenStore':0,'DestroyIcon':0,'MapViewOfFile':0,'TlsFree':0,'GetModuleHandleA':0,'IsWindowVisible':0,'SetMenu':0,'GlobalFlags':0,'ExtTextOutW':0,'UnionRect':0,'GetCurrentThreadId':0,'InitializeSecurityDescriptor':0,'GetDiskFreeSpaceA':0,'OpenThreadToken':0,'UuidCreate':0,'GetFileVersionInfoA':0,'SetViewportExtEx':0,'ReportEventW':0,'VirtualFree':0,'GetFileVersionInfoW':0,'GetFocus':0,'SetSecurityDescriptorGroup':0,'UnhookWindowsHookEx':0,'SetCursor':0,'GetUserNameExW':0,'GetFileVersionInfoSizeA':0,'SetMapMode':0,'GetWindowOrgEx':0,'GetOverlappedResult':0,'SysAllocString':0,'SafeArrayCreate':0,'EnableScrollBar':0,'InitializeAcl':0,'GetFileVersionInfoSizeW':0,'fflush':0,'PathIsDirectoryW':0,'SystemTimeToTzSpecificLocalTime':0,'GetProcessId':0,'FreeEnvironmentStringsA':0,'DeleteCriticalSection':0,'OemToCharBuffA':0,'GrayStringW':0,'EndPaint':0,'RevokeDragDrop':0,'SetErrorMode':0,'IntersectClipRect':0,'FreeEnvironmentStringsW':0,'GlobalFindAtomA':0,'GetMenuItemID':0,'GetLocaleInfoW':0,'GetCursorPos':0,'SetStdHandle':0,'GetFileTime':0,'ImageList_SetOverlayImage':0,'SafeArrayPtrOfIndex':0,'WideCharToMultiByte':0,'CreatePalette':0,'InterlockedExchange':0,'_lopen':0,'__dllonexit':0,'GetSystemTimeAsFileTime':0,'CharLowerBuffA':0,'SetTextAlign':0,'strstr':0,'ioctlsocket':0,'StretchBlt':0,'Escape':0,'GetFullPathNameA':0,'WSAStartup':0,'GetWindowTextLengthA':0,'ScaleViewportExtEx':0,'ResumeThread':0,'CoRevokeClassObject':0,'PathFindFileNameW':0,'GetTopWindow':0,'InitializeCriticalSection':0,'GetWindowTextW':0,'GlobalHandle':0,'Arc':0,'GetWindowTextLengthW':0,'Process32FirstW':0,'GetFullPathNameW':0,'InvalidateRgn':0,'SetBkColor':0,'CoGetClassObject':0,'SetRectRgn':0,'CertEnumCertificatesInStore':0,'GetParent':0,'YAXXZ':0,'SetPropA':0,'CharPrevW':0,'ImageList_SetIconSize':0,'PathIsUNCW':0,'CheckRadioButton':0,'GetSystemDefaultLangID':0,'CreateRectRgnIndirect':0,'Shell_NotifyIconW':0,'ImageList_DragShowNolock':0,'GlobalFindAtomW':0,'VariantInit':0,'SHGetFileInfoA':0,'HeapSetInformation':0,'GetFileSecurityW':0,'GetVolumeInformationA':0,'GetPrivateProfileStringA':0,'_CorExeMain':0,'GetSystemDefaultLCID':0,'exit':0,'EnumCalendarInfoW':0,'SHGetFileInfoW':0,'GetPrivateProfileStringW':0,'FindNextChangeNotification':0,'ImageList_Write':0,'GlobalSize':0,'LoadAcceleratorsW':0,'RegisterClassW':0,'ScrollWindow':0,'OleUIBusyW':0,'UAE':0,'SelectPalette':0,'GetWindowTextA':0,'ConvertDefaultLocale':0,'LineTo':0,'WinHelpW':0,'ExitThread':0,'RegisterClassA':0,'ImageList_Add':0,'DrawFocusRect':0,'SetTimer':0,'TerminateProcess':0,'socket':0,'IsDialogMessageW':0,'ReuseDDElParam':0,'CheckTokenMembership':0,'TranslateMDISysAccel':0,'UnpackDDElParam':0,'CryptMsgClose':0,'SetEndOfFile':0,'_exit':0,'RegisterDragDrop':0,'IsDialogMessageA':0,'CloseHandle':0,'BringWindowToTop':0,'RegisterWindowMessageW':0,'CopySid':0,'MapVirtualKeyA':0,'GetWindowExtEx':0,'SafeArrayGetUBound':0,'SHChangeNotify':0,'OpenProcess':0,'TerminateThread':0,'LoadLibraryW':0,'GetPrivateProfileIntA':0,'GetExitCodeProcess':0,'QueryPerformanceCounter':0,'RegisterWindowMessageA':0,'VirtualProtect':0,'LoadLibraryA':0,'_onexit':0,'GetClassInfoExW':0,'CryptCreateHash':0,'CreateDCA':0,'RegisterEventSourceW':0,'SetWindowLongW':0,'InflateRect':0,'SetCapture':0,'ReleaseCapture':0,'wcslen':0,'ChooseColorA':0,'ImageList_Read':0,'SetWindowLongA':0,'__setusermatherr':0,'CLSIDFromString':0,'DebugBreak':0,'GetProcessHeap':0,'CreateFileMappingW':0,'RemovePropA':0,'RemoveDirectoryW':0,'__p__commode':0,'DrawIconEx':0,'FindFirstFileExA':0,'CryptAcquireContextW':0,'GetUserDefaultUILanguage':0,'CertFindCertificateInStore':0,'atoi':0,'RemovePropW':0,'CharLowerBuffW':0,'CreateFileMappingA':0,'DuplicateHandle':0,'FindFirstFileExW':0,'PostMessageW':0,'GetClassNameW':0,'InsertMenuA':0,'WriteProcessMemory':0,'recv':0,'GetTimeZoneInformation':0,'FreeSid':0,'GetTextExtentPoint32A':0,'ShellExecuteW':0,'SystemTimeToVariantTime':0,'strrchr':0,'CopyFileA':0,'CertFreeCertificateChain':0,'LoadTypeLib':0,'InsertMenuW':0,'PathFindExtensionW':0,'GetErrorInfo':0,'GetTextExtentPoint32W':0,'ShellExecuteA':0,'OpenClipboard':0,'GetLastError':0,'CLSIDFromProgID':0,'IntersectRect':0,'InternetCrackUrlW':0,'ExtractIconW':0,'GetConsoleCP':0,'ModifyMenuW':0,'CryptReleaseContext':0,'CryptEncryptMessage':0,'htons':0,'RemoveDirectoryA':0,'GetShortPathNameA':0,'wvsprintfW':0,'MessageBoxW':0,'AppendMenuA':0,'GetBitmapBits':0,'RegEnumKeyW':0,'MessageBoxA':0,'GetCursor':0,'DestroyCursor':0,'wvsprintfA':0,'OleGetClipboard':0,'RegEnumKeyA':0,'Polyline':0,'CreateDIBSection':0,'InterlockedCompareExchange':0,'RpcStringFreeW':0,'SetScrollInfo':0,'CertGetNameStringW':0,'EndDeferWindowPos':0,'SuspendThread':0,'RectVisible':0,'QueryPerformanceFrequency':0,'DeleteMenu':0,'timeGetTime':0,'YAXPAX':0,'SHGetSpecialFolderPathA':0,'Shell_NotifyIconA':0,'CharToOemA':0,'SetCursorPos':0,'FindNextFileW':0,'MonitorFromWindow':0,'SetRect':0,'FreeResource':0,'InvalidateRect':0,'VariantCopy':0,'OpenEventA':0,'StgCreateDocfileOnILockBytes':0,'VirtualAlloc':0,'FindResourceW':0,'VariantClear':0,'CreateSolidBrush':0,'Sleep':0,'IsBadReadPtr':0,'SetBkMode':0,'IsBadCodePtr':0,'StrRetToStrW':0,'FindResourceA':0,'GetKeyboardType':0,'DllCharacteristics':0,'BaseOfCode':0,'MajorLinkerVersion':0,'MinorOperatingSystemVersion':0,'Machine':0,'MajorSubsystemVersion':0,'LoaderFlags':0,'SizeOfStackCommit':0,'SizeOfUninitializedData':0,'MinorSubsystemVersion':0,'SizeOfHeapReserve':0,'SizeOfHeapCommit':0,'SizeOfStackReserve':0,'BaseOfData':0,'SizeOfHeaders':0,'Subsystem':0,'MinorImageVersion':0,'MajorImageVersion':0,'FileAlignment':0,'MajorOperatingSystemVersion':0,'SizeOfOptionalHeader':0,'AddressOfEntryPoint':0,'SectionAlignment':0,'SizeOfCode':0,'Characteristics':0,'SizeOfInitializedData':0,'SizeOfImage':0,'NumberOfRvaAndSizes':0,'ImageBase':0,'MinorLinkerVersion':0,'CheckSum':0}
    list10 = []
    list6 = []
    fullPath2 = os.path.join(dirName,entry)
    f = open(fullPath2, "r")
    y = f.readlines()
    for i , x in enumerate(y):
        p = x.split()
        if 'dll' in x or 'DLL' in x:
            data = x.split(" ")
            data1 = data[0].split(".")
            stringcount = len(data1)
            if stringcount > 2:
                if data1[2] in let.keys():
                    let.update({data1[2] :1})

        data = x.split()
        stringcount = len(data) 
        if stringcount == 4:
            data1 = data[2].split(":")
            if data1[0] in let.keys():
                w = let[data1[0]]
                if w ==0:
                    e = data[3]
                    try:
                        e= int(e, 0)
                    except Exception as bx:
                        e =0
                    let.update({data1[0] :e})
                    
                    
    v =0
    for i in list9:
        t = let.get(i)
        list10.insert(v,t)
        v = v +1
    list6.append(list10)
    P = np.array(list6)
    X = np.array(P[:,0:631])
    filename = 'sharadstatic.sav'
    loaded_model = pickle.load(open(filename, 'rb'))
    rf_predictions = loaded_model.predict(X)
    return rf_predictions
    
    
                    
                    
                    
str =""
str = raw_input("Enter the name of  path: ");
dirName = str;
entries = os.listdir(str)
with open('static.csv', 'a+') as csvfile:
    filewriter = csv.writer(csvfile, delimiter=',',quotechar='|', quoting=csv.QUOTE_MINIMAL)
    filewriter.writerow(['File_Hash', 'Predicted Label'])
for entry in entries:
    fullPath = os.path.join(dirName, entry)
    i = os.listdir(fullPath)
    for l in i:
        if (l == "Structure_Info.txt"):
            f = fun1(fullPath,l)
            #print entry
            #print f
            if f == 0:
                ram = 'B'
            if f == 1:
                ram = 'M'
            with open('static.csv', 'a+') as csvfile:
                filewriter = csv.writer(csvfile, delimiter=',',quotechar='|', quoting=csv.QUOTE_MINIMAL)
                filewriter.writerow([entry, ram])
            
        
          


# In[ ]:




