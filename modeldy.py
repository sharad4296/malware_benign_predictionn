#!/usr/bin/env python
# coding: utf-8

# In[ ]:


import random
from sklearn.model_selection import train_test_split
import os
import json
import re 
from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer 
import pandas as pd 
import numpy as np
from sklearn.ensemble import RandomForestClassifier
import pickle

P = np.array(list6)
X = np.array(P[:,0:256])
y = np.array(P[:,-1])
X_train, X_test,train_labels, test_labels = train_test_split(X,y,test_size=0.01,random_state=42)
model = RandomForestClassifier(n_estimators=100,random_state=42,max_features = 'sqrt',n_jobs=-1, verbose = 1)
classifier = model.fit(X_train,train_labels)
filename = 'sharaddynamic.sav'
pickle.dump(classifier, open(filename, 'wb'))
loaded_model = pickle.load(open(filename, 'rb'))
rf_predictions = loaded_model.predict(X_test)




